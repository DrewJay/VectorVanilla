!function(e,t){for(var n in t)e[n]=t[n]}(exports,function(e){var t={};function n(r){if(t[r])return t[r].exports;var o=t[r]={i:r,l:!1,exports:{}};return e[r].call(o.exports,o,o.exports,n),o.l=!0,o.exports}return n.m=e,n.c=t,n.d=function(e,t,r){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:r})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var r=Object.create(null);if(n.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var o in e)n.d(r,o,function(t){return e[t]}.bind(null,o));return r},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s=0)}([function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(1);t.plot=r.plot,t.clear=r.clear,t.stack=r.stack},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(2),o=Number(process.env.PORT)||8080,i=new r.Server(o);function s(e,n){a(e,n);var r=n?{data:e,layout:n}:{data:e};t.plots.push(r)}function a(e,t){if(!(e instanceof Array)||0===e.length)throw new TypeError("Plot data must be an array with at least 1 element");if(t&&!(t instanceof Object))throw new TypeError("Layout must be an object")}t.plots=[],t.plotContainer={},t.clear=function(){t.plots=[]},t.stack=s,t.plot=function(e,n){e&&(a(e,n),s(e,n));var r=Object.keys(t.plotContainer).length;t.plotContainer[r]={opened:!1,pending:!1,plots:t.plots},t.plots=[],i.spawn(t.plotContainer)}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(3),o=n(4),i=n(5),s=n(6),a=n(7),c=function(){function e(e){var t=this;this.plotsContainer={},this.sockets={},this.nextSocketID=0,this.port=e,this.instance=this.createServer(),this.instance.on("connection",(function(e){var n=t.nextSocketID++;t.sockets[n]=e,e.on("close",(function(){delete t.sockets[n]}))}))}return e.prototype.spawn=function(e){this.plotsContainer=e,this.instance.address()||this.instance.listen(this.port),this.openBrowserWindow()},e.prototype.clean=function(){this.instance.address()&&this.instance.close();for(var e=0,t=Object.values(this.sockets);e<t.length;e++){t[e].destroy()}this.plotsContainer={}},e.prototype.openBrowserWindow=function(){for(var e=0,t=Object.entries(this.plotsContainer);e<t.length;e++){var n=t[e];n[1].opened||n[1].pending||(n[1].pending=!0,this.openWindow("http://localhost:"+this.port+"/plots/"+n[0]+"/index.html"))}},e.prototype.openWindow=function(e){switch(s.type()){case"Linux":r.exec("xdg-open "+e);break;case"Darwin":r.exec("open "+e);break;case"Windows_NT":r.exec("start "+e)}},e.prototype.createServer=function(){var e=this;return i.createServer((function(t,n){e.serveData(t,n),e.serveWebsite(t,n)}))},e.prototype.serveData=function(e,t){if(e&&e.url&&e.url.match(/data\/[0-9]+/)){var n=e.url.split("/"),r=+n[n.length-1],o=this.plotsContainer[r],i=o&&o.plots;this.plotsContainer[r].opened=!0,this.plotsContainer[r].pending=!1,t.end(JSON.stringify(i)),this.close()}},e.prototype.serveWebsite=function(e,t){var n=this;if(e&&e.url&&e.url.match(/plots\/[0-9]+\/index.html/)){var r=(i=e.url.split("/"))[i.length-2];o.readFile(a.join(__dirname,"..","www","index.html"),"utf-8",(function(e,n){if(e)return t.writeHead(404),void t.end(JSON.stringify(e));n=n.replace("{{plotid}}",r),t.writeHead(200),t.end(n)}))}else{if(!(e&&e.url&&(e.url.match(/nodeplotlib.min.js/)||e.url&&e.url.match(/plotly.min.js/))))return t.writeHead(404),void t.end("Server address not found");var i,s=(i=e.url.split("/"))[i.length-1];o.readFile(a.join(__dirname,"..","www",s),"utf-8",(function(e,r){if(e)return t.writeHead(404),void t.end(JSON.stringify(e));"nodeplotlib.min.js"===s&&(r=r.replace("{{port}}",""+n.port)),t.setHeader("content-type","text/javascript"),t.writeHead(200),t.end(r)}))}},e.prototype.close=function(){var e=Object.values(this.plotsContainer).reduce((function(e,t){return e||t.pending}),!1),t=Object.values(this.plotsContainer).reduce((function(e,t){return e&&t.opened}),!0);this.instance&&!e&&t&&this.clean()},e}();t.Server=c},function(e,t){e.exports=require("child_process")},function(e,t){e.exports=require("fs")},function(e,t){e.exports=require("http")},function(e,t){e.exports=require("os")},function(e,t){e.exports=require("path")}]));